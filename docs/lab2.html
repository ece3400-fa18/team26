<!DOCTYPE html>
<html lang="en">

  <head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>ECE 3400 Team 26</title>

    <!-- Bootstrap core CSS -->
    <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom fonts for this template -->
    <link href="vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css">
    <link href='https://fonts.googleapis.com/css?family=Kaushan+Script' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Roboto+Slab:400,100,300,700' rel='stylesheet' type='text/css'>

    <!-- Custom styles for this template -->
    <link href="css/agency.css" rel="stylesheet">

  </head>

  <body id="page-top">

    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top" id="mainNav">
      <div class="container">
        <a class="navbar-brand js-scroll-trigger" href="index.html">Home</a>
        
      </div>
    </nav>

    <!-- Header -->
     <div class="pagehead">
      <div class="container">
        <h2>  </h2>
      </div>
    </div> 

    <div class="container">
        <div class="row">
          <div class="col-lg-8 mx-auto">
            <div class="lab-page">
              <!-- Project Details Go Here -->
              <h2 class="text-uppercase text-left">Lab 2: Analog Circuitry and FFTs</h2>
              <p class="item-intro text-muted"> In this lab, we added sensors to the robot. <br>
              One is a microphone circuit that will detect a 660Hz whistle blow signifying the beginning of the maze mapping. The other will capture inputs from an IR sensor to detect nearby robots emitting IR at 6.08kHz, and distinguish them from decoys emitting at 18kHz.</p>
  
              <!--<iframe width="560" height="315" align="middle" src="https://www.youtube.com/embed/wf3T-4biOp0" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>-->
                
              <h3> Acoustic Team </h3>
              <p> Priya and Vini worked on the acoustic functionalities. <br>
              Assembling the microphone circuit. </p>             
              <!--<img class="img-fluid d-block mx-auto" width="400" height="80" src="./img/lab1/part 1.png" alt="">-->


              
              <h3> Optical Team </h3>
              <p> Joyce and Nathalia worked on the optical functionalities. <br>
              Assembling the IR Circuit </p>
              
              <img class="img-fluid d-block mx-auto" width="250" height="80" src="./img/lab2/optics schematic 1.jpg" alt="">
              <p> We first connected the photoresistor according to the circuit above. When powered up, we checked for functionality using our phone cameras. Because the cameras don’t have an IR filter, the photoresistor would glow blue, even though our naked eyes wouldn’t pick up anything.</p>
              
              <img class="img-fluid d-block mx-auto" width="250" height="80" src="./img/lab2/optics circuit 1.jpg" alt="">
              <p> We didn't have the 9V battery so we connect the IR hat to the DC power supply, set to 9V. The oscilloscope is connected to the output and the ground to measure the signal. This unit test is done without additional circuit.</p>
              
              <img class="img-fluid d-block mx-auto" width="250" height="80" src="./img/lab2/optics circuit 2.jpg" alt="">
              <p> Consequently, we had to add an operational amplifier.
              To only detect the 7kHz signal. We compute the bin number of which 7kHz would be present. We determined the bin number is 45 to 50, so we read values from those bin only. When they peak, we output that the treasure is detected.</p>
              
              <p> Main loop </p>
              <!-- HTML generated using hilite.me --><div style="background: #ffffff; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%">void loop() {

  <span style="color: #008800; font-weight: bold">while</span>(<span style="color: #0000DD; font-weight: bold">1</span>){
    cli(); <span style="color: #333333">//</span>UDRE interrupt
    <span style="color: #008800; font-weight: bold">for</span>(<span style="color: #007020">int</span> i <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">0</span>; i <span style="color: #333333">&lt;</span> <span style="color: #0000DD; font-weight: bold">512</span>; i<span style="color: #333333">+=</span><span style="color: #0000DD; font-weight: bold">2</span>){
      <span style="color: #008800; font-weight: bold">while</span>(<span style="color: #FF0000; background-color: #FFAAAA">!</span>(ADCSRA <span style="color: #333333">&amp;</span> <span style="color: #005588; font-weight: bold">0x10</span>)); <span style="color: #333333">//</span>waiting <span style="color: #008800; font-weight: bold">for</span> adc to be ready
      ADCSRA <span style="color: #333333">=</span> <span style="color: #005588; font-weight: bold">0xf5</span>; <span style="color: #333333">//</span>restart ADC
      byte m <span style="color: #333333">=</span> ADCL;
      byte j <span style="color: #333333">=</span> ADCH;
      <span style="color: #007020">int</span> k <span style="color: #333333">=</span> (j <span style="color: #333333">&lt;&lt;</span> <span style="color: #0000DD; font-weight: bold">8</span>) <span style="color: #333333">|</span> m;
      k <span style="color: #333333">-=</span> <span style="color: #005588; font-weight: bold">0x0200</span>;
      k <span style="color: #333333">&lt;&lt;=</span> <span style="color: #0000DD; font-weight: bold">6</span>;
      fft_input[i] <span style="color: #333333">=</span> k;
      fft_input[i<span style="color: #333333">+</span><span style="color: #0000DD; font-weight: bold">1</span>] <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">0</span>;
    } 

    fft_window();
    fft_reorder();
    fft_run();
    fft_mag_log();
    sei(); <span style="color: #333333">//</span>turns interrupts back on

    Serial<span style="color: #333333">.</span>println(<span style="background-color: #fff0f0">&quot;start treasure hunt&quot;</span>);
    <span style="color: #008800; font-weight: bold">for</span> (byte i <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">0</span>; i <span style="color: #333333">&lt;</span> FFT_N<span style="color: #333333">/</span><span style="color: #0000DD; font-weight: bold">2</span>; i<span style="color: #333333">++</span>){
      Serial<span style="color: #333333">.</span>println(fft_log_out[i]);
    }
    
    trasureDetect();
  }

}
</pre></div>

              <p> An example of one loop inside the treasure detection subroutine. This is repeated of bin sizes of 7 (as below), 12, and 17. </p>
              <!-- HTML generated using hilite.me --><div style="background: #ffffff; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%">  <span style="color: #007020">int</span> max_7_bin <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">0</span>;
  <span style="color: #008800; font-weight: bold">for</span> (<span style="color: #007020">int</span> i <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">46</span>; i <span style="color: #333333">&lt;</span> <span style="color: #0000DD; font-weight: bold">50</span>; i<span style="color: #333333">++</span>){
    <span style="color: #007020">int</span> x <span style="color: #333333">=</span> (<span style="color: #007020">int</span>) fft_log_out[i];
    <span style="color: #008800; font-weight: bold">if</span>(x <span style="color: #333333">&gt;</span> max_7_bin){
      max_7_bin <span style="color: #333333">=</span> x;
    }
  }
</pre></div>


              <h3> Work Distribution </h3>
              <p> The Lab 2 Work Distribution is as follows: <br> 
                  &emsp; -  <br>
                  The Lab 2 Report Work Distribution is as follows: <br>
                  &emsp; -  <br>
                  The website work distribution is as follows: <br>
                  &emsp; - Nathalia: Website Set Up and Lab 2<br>
              </p>
            </div>
          </div>
        </div>
      </div>

    

    <!-- Footer -->
    <footer>
      <div class="container">
        <div class="row">
          <div class="col-md-4">
            <span class="copyright">Copyright &copy; Your Website 2018</span>
          </div>
          <div class="col-md-4">
            <ul class="list-inline social-buttons">
              <li class="list-inline-item">
                <a href="#">
                  <i class="fab fa-twitter"></i>
                </a>
              </li>
              <li class="list-inline-item">
                <a href="#">
                  <i class="fab fa-facebook-f"></i>
                </a>
              </li>
              <li class="list-inline-item">
                <a href="#">
                  <i class="fab fa-linkedin-in"></i>
                </a>
              </li>
            </ul>
          </div>
          <div class="col-md-4">
            <ul class="list-inline quicklinks">
              <li class="list-inline-item">
                <a href="#">Privacy Policy</a>
              </li>
              <li class="list-inline-item">
                <a href="#">Terms of Use</a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </footer>

 

    <!-- Bootstrap core JavaScript -->
    <script src="vendor/jquery/jquery.min.js"></script>
    <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

    <!-- Plugin JavaScript -->
    <script src="vendor/jquery-easing/jquery.easing.min.js"></script>

    <!-- Contact form JavaScript -->
    <script src="js/jqBootstrapValidation.js"></script>
    <script src="js/contact_me.js"></script>

    <!-- Custom scripts for this template -->
    <script src="js/agency.min.js"></script>

  </body>

</html>
